/* 字體導入 - 必須在最前面 */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* 基礎樣式重置和設定 */
@layer base {
  * {
    box-sizing: border-box;
  }
  
  html {
    scroll-behavior: smooth;
    -webkit-tap-highlight-color: transparent;
  }
  
  body {
    @apply font-noto bg-background-default text-text-primary;
    @apply overscroll-y-none;
    /* 防止iOS上的彈性滾動 */
    position: fixed;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }
  
  #root {
    @apply w-full h-full overflow-auto;
    @apply safe-top safe-bottom;
  }
  
  /* 輸入框樣式重置 */
  input, textarea, select, button {
    @apply font-noto;
  }
  
  /* 移除輸入框在iOS上的默認樣式 */
  input[type="text"],
  input[type="email"], 
  input[type="password"],
  input[type="tel"],
  input[type="search"],
  textarea {
    @apply appearance-none;
    -webkit-appearance: none;
    border-radius: 0;
  }
  
  /* 滾動條美化 */
  ::-webkit-scrollbar {
    @apply w-1;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-gray-100;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-primary-300 rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-primary-500;
  }
}

/* 組件層級樣式 */
@layer components {
  /* 按鈕基礎樣式 */
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 rounded-medium font-medium;
    @apply transition-all duration-fast touch-target;
    @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
    @apply active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-primary {
    @apply bg-gradient-primary text-white shadow-small;
    @apply hover:shadow-rainbow focus:ring-primary-500;
    @apply active:bg-primary-600;
  }
  
  .btn-secondary {
    @apply bg-gradient-secondary text-white shadow-small;
    @apply hover:shadow-medium focus:ring-secondary-500;
    @apply active:bg-secondary-600;
  }
  
  .btn-accent {
    @apply bg-gradient-accent text-gray-800 shadow-small;
    @apply hover:shadow-medium focus:ring-accent-500;
    @apply active:bg-accent-600;
  }
  
  .btn-ghost {
    @apply bg-transparent text-text-primary border border-border-light;
    @apply hover:bg-gray-50 focus:ring-gray-500;
    @apply active:bg-gray-100;
  }
  
  .btn-rainbow {
    @apply bg-rainbow-horizontal text-white shadow-rainbow;
    @apply hover:shadow-rainbow-lg hover:scale-105;
    @apply focus:ring-primary-500;
  }
  
  /* 輸入框樣式 */
  .input {
    @apply w-full px-3 py-2 border border-border-light rounded-medium;
    @apply bg-white text-text-primary placeholder-text-disabled;
    @apply focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent;
    @apply transition-all duration-fast;
  }
  
  .input-error {
    @apply border-error-500 focus:ring-error-500;
  }
  
  /* 卡片樣式 */
  .card {
    @apply bg-background-card rounded-large shadow-small border border-border-light;
    @apply transition-all duration-fast;
  }
  
  .card-hover {
    @apply hover:shadow-medium hover:-translate-y-1;
  }
  
  .card-rainbow {
    @apply border-2 border-transparent bg-gradient-to-r from-primary-500 via-accent-500 to-secondary-500 p-0.5;
  }
  
  .card-rainbow-content {
    @apply bg-white rounded-large p-4 h-full;
  }
  
  /* 導航樣式 - 高飽和度彩虹設計 */
  .top-nav {
    @apply fixed top-0 left-0 right-0;
    @apply flex items-center justify-between px-4 py-3;
    @apply bg-rainbow-horizontal backdrop-blur-sm border-b border-rainbow-red/30;
    @apply shadow-rainbow-lg safe-top;
    background: linear-gradient(135deg, 
      #FF3B30 0%, 
      #FF9500 20%, 
      #FFCC00 40%, 
      #34C759 60%, 
      #007AFF 80%, 
      #AF52DE 100%
    );
    height: var(--header-height, 60px);
    z-index: 1035;
  }
  
  .nav-left, .nav-right {
    @apply flex items-center gap-2;
    @apply min-w-0 flex-1;
  }
  
  .nav-center {
    @apply flex items-center justify-center flex-1;
  }
  
  .nav-title {
    @apply text-lg font-bold text-white truncate drop-shadow-lg;
    text-shadow: 
      0 1px 3px rgb(95, 158, 209),
      0 0 8px rgb(44, 86, 213),
      1px 1px 0 rgba(39, 53, 206, 0.9),
      -1px -1px 0 rgba(44, 14, 211, 0.9),
      1px -1px 0 rgba(102, 16, 231, 0.9),
      -1px 1px 0 rgba(28, 217, 255, 0.9);
  }
  
  .nav-btn {
    @apply flex items-center justify-center p-2 rounded-medium;
    @apply text-white hover:text-white hover:bg-white/25;
    @apply transition-all duration-fast touch-target;
    @apply active:scale-95 hover:shadow-medium backdrop-blur-sm;
    text-shadow: 
      0 1px 3px rgb(95, 158, 209),
      0 0 8px rgb(44, 86, 213),
      1px 1px 0 rgba(39, 53, 206, 0.9),
      -1px -1px 0 rgba(44, 14, 211, 0.9),
      1px -1px 0 rgba(102, 16, 231, 0.9),
      -1px 1px 0 rgba(201, 30, 30, 0.9);
    filter: drop-shadow(0 0 4px rgba(125, 26, 231, 1));
  }
  
  .nav-btn svg {
    filter: drop-shadow(0 1px 2px rgba(0, 102, 255, 0.9)) 
            drop-shadow(0 0 4px rgba(38, 0, 255, 0.7));
  }
  
  .bottom-nav {
    @apply fixed bottom-0 left-0 right-0;
    @apply flex items-center justify-around px-2 py-2;
    @apply backdrop-blur-sm border-t border-rainbow-purple/30;
    @apply shadow-rainbow-lg safe-bottom;
    background: linear-gradient(45deg, 
      #AF52DE 0%, 
      #007AFF 20%, 
      #34C759 40%, 
      #FFCC00 60%, 
      #FF9500 80%, 
      #FF3B30 100%
    );
    height: var(--bottom-nav-height, 80px);
    z-index: 1040;
  }
  
  .nav-item {
    @apply flex flex-col items-center justify-center gap-1 p-2 rounded-medium;
    @apply text-white transition-all duration-fast touch-target;
    @apply hover:text-white hover:bg-white/25 hover:scale-105;
    @apply active:scale-95 backdrop-blur-sm;
    min-width: 60px;
    text-shadow: 
      0 1px 3px rgb(95, 158, 209),
      0 0 8px rgb(44, 86, 213),
      1px 1px 0 rgba(39, 53, 206, 0.9),
      -1px -1px 0 rgba(44, 14, 211, 0.9),
      1px -1px 0 rgba(102, 16, 231, 0.9),
      -1px 1px 0 rgba(201, 30, 30, 0.9);
    filter: drop-shadow(0 0 4px rgba(43, 62, 236, 1));
  }
  
  .nav-item svg {
    filter: drop-shadow(0 3px 5px rgba(30, 143, 203, 0.9)) 
            drop-shadow(10 10 4px rgba(90, 56, 214, 0.7));
  }
  
  .nav-item-active {
    @apply text-white bg-white/30 shadow-medium;
    backdrop-filter: blur(8px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.2);
    text-shadow: 
      0 1px 3px rgba(0, 0, 0, 1),
      0 0 8px rgba(0, 0, 0, 0.8),
      1px 1px 0 rgba(0, 0, 0, 1),
      -1px -1px 0 rgba(0, 0, 0, 1),
      1px -1px 0 rgba(0, 0, 0, 1),
      -1px 1px 0 rgba(0, 0, 0, 1);
  }
  
  /* 載入動畫 */
  .loading-spinner {
    @apply w-6 h-6 border-2 border-gray-300 border-t-primary-500 rounded-full;
    animation: spin 1s linear infinite;
  }
  
  .loading-skeleton {
    @apply bg-gray-200 animate-pulse rounded;
  }
  
  /* 模態框樣式 */
  .modal-backdrop {
    @apply fixed inset-0 bg-background-overlay z-modal-backdrop;
    backdrop-filter: blur(4px);
  }
  
  .modal-content {
    @apply bg-white rounded-large shadow-large max-w-sm mx-auto mt-20 z-modal;
    @apply transform transition-all duration-base;
  }
  
  /* Toast通知樣式 */
  .toast {
    @apply px-4 py-2 rounded-medium shadow-medium z-toast;
    @apply transform transition-all duration-fast;
  }
  
  .toast-success {
    @apply bg-success-500 text-white;
  }
  
  .toast-error {
    @apply bg-error-500 text-white;
  }
  
  .toast-warning {
    @apply bg-warning-500 text-white;
  }
  
  .toast-info {
    @apply bg-info-500 text-white;
  }
}

/* 工具類 */
@layer utilities {
  /* 文字省略 */
  .text-ellipsis {
    @apply truncate;
  }
  
  .text-ellipsis-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .text-ellipsis-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* 響應式隱藏/顯示 */
  .mobile-only {
    @apply block md:hidden;
  }
  
  .desktop-only {
    @apply hidden md:block;
  }
  
  /* 無障礙樣式 */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  
  /* 可聚焦元素樣式 */
  .focus-visible {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2;
  }
}

/* 動畫定義 */
@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Dark mode 支持 */
@media (prefers-color-scheme: dark) {
  .dark {
    /* 深色模式變量可在此處定義 */
  }
}

/* 列印樣式 */
@media print {
  * {
    color: black !important;
    background: white !important;
  }
}